<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<Target Name="AfterBackupCurrentHansKindbergXmlTransform">
		<Message
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'AfterBackupCurrentHansKindbergXmlTransform'"
		/>
		<Message
			Condition="Exists($(HansKindbergXmlTransformBackupPath)) AND Exists(%(HansKindbergXmlTransformSource.Identity))"
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'AfterBackupCurrentHansKindbergXmlTransform': Backing up '%(HansKindbergXmlTransformSource.Identity)' to '$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)'."
		/>
		<Copy
			Condition="Exists($(HansKindbergXmlTransformBackupPath)) AND Exists(%(HansKindbergXmlTransformSource.Identity))"
			DestinationFiles="$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)"
			SourceFiles="%(HansKindbergXmlTransformSource.Identity)"
		/>
	</Target>
	<Target Name="AfterRestorePreviousHansKindbergXmlTransform">
		<Message
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'AfterRestorePreviousHansKindbergXmlTransform'"
		/>
		<Message
			Condition="Exists('$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)')"
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'AfterRestorePreviousHansKindbergXmlTransform': Restoring '$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)' to '%(HansKindbergXmlTransformSource.Identity)'."
		/>
		<Copy
			Condition="Exists('$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)')"
			DestinationFiles="%(HansKindbergXmlTransformSource.Identity)"
			SourceFiles="$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)"
		/>
		<Message
			Condition="!Exists('$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)') AND Exists(%(HansKindbergXmlTransformSource.Identity))"
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'AfterRestorePreviousHansKindbergXmlTransform': Deleting '%(HansKindbergXmlTransformSource.Identity)'."
		/>
		<Delete
			Condition="!Exists('$(HansKindbergXmlTransformBackupPath)%(HansKindbergXmlTransformSource.Identity)') AND Exists(%(HansKindbergXmlTransformSource.Identity))"
			Files="%(HansKindbergXmlTransformSource.Identity)"
		/>
	</Target>
	<PropertyGroup>
		<PopulateHansKindbergXmlTransformSourceDependsOn>
			$(PopulateHansKindbergXmlTransformSourceDependsOn);
			PopulateFromEPiServerApplicationFilesConfigurationTemplate;
		</PopulateHansKindbergXmlTransformSourceDependsOn>
	</PropertyGroup>
	<Target Name="PopulateFromEPiServerApplicationFilesConfigurationTemplate">
		<Message
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'PopulateFromEPiServerApplicationFilesConfigurationTemplate'"
		/>
		<Message
			Condition="!Exists(%(EPiServerApplicationFilesConfigurationTemplate.Transform))"
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'PopulateFromEPiServerApplicationFilesConfigurationTemplate': Copying '%(EPiServerApplicationFilesConfigurationTemplate.Identity)' to '%(EPiServerApplicationFilesConfigurationTemplate.Destination)'."
		/>
		<Copy
			Condition="!Exists(%(EPiServerApplicationFilesConfigurationTemplate.Transform))"
			DestinationFiles="%(EPiServerApplicationFilesConfigurationTemplate.Destination)"
			SourceFiles="%(EPiServerApplicationFilesConfigurationTemplate.Identity)"
		/>
		<Message
			Condition="Exists(%(EPiServerApplicationFilesConfigurationTemplate.Transform))"
			Importance="$(EPiServerApplicationFilesMessageImportance)"
			Text="Target 'PopulateFromEPiServerApplicationFilesConfigurationTemplate': Transforming '%(EPiServerApplicationFilesConfigurationTemplate.Identity)' with '%(EPiServerApplicationFilesConfigurationTemplate.Transform)' to '%(EPiServerApplicationFilesConfigurationTemplate.Destination)'."
		/>
		<TransformXml
			Condition="Exists(%(EPiServerApplicationFilesConfigurationTemplate.Transform))"
			Destination="%(EPiServerApplicationFilesConfigurationTemplate.Destination)"
			Source="%(EPiServerApplicationFilesConfigurationTemplate.Identity)"
			StackTrace="True"
			Transform="%(EPiServerApplicationFilesConfigurationTemplate.Transform)"
		/>
	</Target>
</Project>